*** Settings ***
Documentation     This suite contains the scripts related to the Manage Custom Queues \ page
Suite Setup       OpenNewBrowseAndloginToApplication
Suite Teardown    Close All Browsers
Test Setup        setFailureCountToZero
Resource          ../../financegeniusresource.txt

*** Variables ***

*** Test Cases ***
verifyQueuesLink
    [Documentation]    This script verifies Manage Custom Queues \ link displayed under Lender Settings section
    Click Element    link=Admin
    Sleep    1
    Wait Until Page Contains Element    link=Lender Settings    ${Timeout}    Lender Settings \ section not appear on page
    Focus    link=Lender Settings
    Click Element    link=Lender Settings
    Sleep    2
    Page Should Contain Element    link=Queues    Queues \ link under Lender Settings page not appeared \ on Admin Page
    Element Text Should Be    link=Queues    Queues    Queues under Lender Settings page has invalid text on Admin Page

verifyQueuesLinkClick
    [Documentation]    This script verifies \ Manage Custom Queues \ link click.
    Click Element    link=Admin
    Sleep    1
    Wait Until Page Contains Element    link=Lender Settings    ${Timeout}    Lender Settings \ section not appear on page
    Click Element    //div[@id='controller_lender_settings']/div/a[2]/i
    Sleep    1
    Focus    link=Queues
    Click Element    link=Queues
    Sleep    1
    Wait Until Page Contains Element    link=Add Queue    ${Timeout}    Manage \ Queues page not loaded properly
    Element Text Should Be    css=h1.subheading    Manage Queues    Manage \ Queues link not functioning properly

verifyManageCustomQueuesPageUI
    [Documentation]    This script verifies Manage Custom Queues \ Page UI
    goToManageCustomQueuesPage
    Sleep    1
    ${V1}=    Run Keyword And Return Status    Element Text Should Be    css=h1.subheading    Manage Queues    Manage Custom Queues \ page has invalid header text
    ${V2}=    Run Keyword And Return Status    Element Text Should Be    link=Add Queue    Add Queue    Add Custom Queue \ link has invalid text on Manage Custom Queues page
    ${V3}=    Run Keyword And Return Status    Page Should Contain Element    css=label > input[type="text"]    Search Text box not present on Manage Custom Queues \ page
    ${V4}=    Run Keyword And Return Status    Page Should Contain List    name=mngCustomQueues_length    Per page drop down not present on Manage Custom Queues \ page
    ${V5}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='mngCustomQueues']/thead/tr/th[2]    Name    Name column name has invalid text on Manage Custom Queues Page
    ${V6}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='mngCustomQueues']/thead/tr/th[3]    Enable    Enable column name has invalid text on Manage Custom Queues Page
    ${V7}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='mngCustomQueues']/thead/tr/th[4]    Description    Description column name has invalid text on Manage Custom Queues Page
    ${V8}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='mngCustomQueues']/thead/tr/th[5]    Total Count    Total Count column name has invalid text on Manage Custom Queues Page
    ${V9}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='mngCustomQueues']/thead/tr/th[6]    Updated On    Updated On column name has invalid text on Manage Custom Queues Page
    ${V10}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='mngCustomQueues']/thead/tr/th[7]    By    By column name has invalid text on Manage Custom Queues Page
    ${V11}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='mngCustomQueues']/thead/tr/th[8]    Status    Status column name has invalid text on Manage Custom Queues Page
    ${AddButtonTooTip}=    Get Element Attribute    link=Add Queue@data-original-title
    ${V12}=    Run Keyword And Return Status    Should Be Equal    Add Queue    ${AddButtonTooTip}
    @{Verification}=    Create List    ${V1}    ${V2}    ${V3}    ${V4}    ${V5}
    ...    ${V6}    ${V7}    ${V8}    ${V9}    ${V10}    ${V11}
    ...    ${V12}
    @{Messages}=    Create List    Manage Custom Queues \ page has invalid header text    Add Custom Queue \ link has invalid text on Manage Custom Queues page    Search Text box not present on Manage Custom Queues \ page    Per page drop down not present on Manage Custom Queues \ page    Name column name has invalid text on Manage Custom Queues Page
    ...    Enable \ column name has invalid text on Manage Custom Queues Page    Description column name has invalid text on Manage Custom Queues Page    Total Count column name has invalid text on Manage Custom Queues Page    Updated On column name has invalid text on Manage Custom Queues Page    By column name has invalid text on Manage Custom Queues Page    Status column name has invalid text on Manage Custom Queues Page
    ...    Add Queues \ link has invalid tool tip on Manage Custom Queues Page
    Set Global Variable    @{GlobalFailureMessages}    @{Messages}
    verifyFailuresFromExecution    @{Verification}
    Run Keyword If    ${FailureCount}>0    Fail    ${MessageToDisplay}

toVerifyAddCustomQueueLink
    [Documentation]    This script verifies Add Custom Queue \ link click
    goToManageCustomQueuesPage
    Focus    link=Add Queue
    Click Element    link=Add Queue
    Sleep    2
    Element Text Should Be    css=h1.subheading    Create Queue    Add Custom Queue link not working properly

toVerifyAddCustomQueuePage
    [Documentation]    This script verifies Add Custom Queue Page UI
    goToManageCustomQueuesPage
    Focus    link=Add Queue
    Click Element    link=Add Queue
    Sleep    2
    ${V1}=    Run Keyword And Return Status    Element Text Should Be    css=h1.subheading    Create Queue    Create Custom Queue page has invalid header text on Create Custom Queue Page
    ${V2}=    Run Keyword And Return Status    Page Should Contain Element    link=Manage Queues    Manage Queues    Manage Queues \ link not present on Create Custom Queue Page
    ${V3}=    Run Keyword And Return Status    Page Should Contain Element    link=Save    Save link not present on Create Custom Queue Page
    ${V4}=    Run Keyword And Return Status    Page Should Contain Element    link=Cancel    Cancel link not present on Create Custom Queue Page
    Comment    Save and Clone Link removed
    Comment    ${V5}=    Run Keyword And Return Status    Page Should Contain Element    link=Save & Clone    Save & Clone link not present on Create Custom Queue Page
    Comment    Branch Overview section
    ${V6}=    Run Keyword And Return Status    Page Should Contain Textfield    name=name    Name \ not present on Create Custom Queue Page
    ${V7}=    Run Keyword And Return Status    Page Should Contain Textfield    name=description    Description \ not present on Create Custom Queue Page
    ${V8}=    Run Keyword And Return Status    Page Should Contain Element    id=enabled    Enabled not present on Create Custom Queue Page
    ${V9}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='mainContent']/form/div/div[3]/div/div[3]/label    Enabled    Enabled label has invalid \ text on Create Custom Queue Page
    Comment    Custom Queue Criteria Section
    ${V10}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='criteriaSetsTable']/thead/tr/th[2]    Custom Queue Criteria    Custom Queue Criteria Section \ has invalid \ text on Create Custom Queue Page
    ${V11}=    Run Keyword And Return Status    Page Should Contain Textfield    id=unique1    Custom Queue Criteria 1 Textbox not present on Create Custom Queue Page
    ${V12}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='criteriaSetDiv_-1']/table/tbody/tr[2]/td[3]    Condition    Condition column name has invalid \ text on Create Custom Queue Page
    ${V13}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='criteriaSetDiv_-1']/table/tbody/tr[2]/td[4]    Attribute    Attribute column name has invalid \ text on Create Custom Queue Page
    ${V14}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='criteriaSetDiv_-1']/table/tbody/tr[2]/td[5]    Method    Method column name has invalid \ text on Create Custom Queue Page
    ${V15}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='criteriaSetDiv_-1']/table/tbody/tr[2]/td[6]    Value    Value column name has invalid \ text on Create Custom Queue Page
    ${V16}=    Run Keyword And Return Status    Page Should Contain List    id=unique2    Attribute \ dropdown \ not present on Create Custom Queue Page
    ${V17}=    Run Keyword And Return Status    Page Should Contain List    id=unique3    Method dropdown \ not present on Create Custom Queue Page
    ${V18}=    Run Keyword And Return Status    Page Should Contain Textfield    id=unique4    Value Textbox not present on Create Custom Queue Page
    ${V19}=    Run Keyword And Return Status    Page Should Contain Element    //a[contains(text(),'Add Custom Queue Criteria')]    Add Custom Queue Criteria link button not present on Create Custom Queue Page
    ${V20}=    Run Keyword And Return Status    Page Should Contain Element    xpath=(//a[contains(text(),'Cancel')])[2]    Cancel button not present on Create Custom Queue Page
    ${V21}=    Run Keyword And Return Status    Page Should Contain Element    //input[@value='Save']    Save button not present on Create Custom Queue Page
    @{Verification}=    Create List    ${V1}    ${V2}    ${V3}    ${V4}    ${V6}
    ...    ${V7}    ${V8}    ${V9}    ${V10}    ${V11}    ${V12}
    ...    ${V13}    ${V14}    ${V15}    ${V16}    ${V17}    ${V18}
    ...    ${V19}    ${V20}    ${V21}
    @{Messages}=    Create List    Create Custom Queue page has invalid header text    Manage Custom Queues link not present on Create Custom Queue Page    Save link not present on Create Custom Queue Page    Cancel link not present on Create Custom Queue Page    Name \ not present on Create Custom Queue Page
    ...    Description \ not present on Create Custom Queue Page    Enabled not present on Create Custom Queue Page    Enabled label has invalid \ text on Create Custom Queue Page    Custom Queue Criteria Section \ has invalid \ text on Create Custom Queue Page    Custom Queue Criteria 1 Textbox not present on Create Custom Queue Page    Condition column name has invalid \ text on Create Custom Queue Page
    ...    Attribute column name has invalid \ text on Create Custom Queue Page    Method column name has invalid \ text on Create Custom Queue Page    Value column name has invalid \ text on Create Custom Queue Page    Attribute \ dropdown \ not present on Create Custom Queue Page    Method dropdown \ not present on Create Custom Queue Page    Value Textbox not present on Create Custom Queue Page
    ...    Add Custom Queue Criteria link button not present on Create Custom Queue Page    Cancel button not present on Create Custom Queue Page    Save button not present on Create Custom Queue Page
    Set Global Variable    @{GlobalFailureMessages}    @{Messages}
    verifyFailuresFromExecution    @{Verification}
    Run Keyword If    ${FailureCount}>0    Fail    ${MessageToDisplay}

addNewCustomQueueEnabledAndVerify
    [Documentation]    This script add New Enabled branch and Verify
    ${Name}=    Generate Random String    7    [LETTERS]
    ${Description}=    Generate Random String    7    [LETTERS]
    Set Global Variable    ${Name}    ${Name}
    Set Global Variable    ${Description}    ${Description}
    addNewCustomQueue    ${Name}    ${Description}    Enabled
    Sleep    1
    Page Should Contain Element    link=Add Queue    Add New Custome Queue not working properly.
    Comment    Verifies on the Queues Page
    Focus    xpath=(//a[contains(text(),'My Queues')])[2]
    Click Element    xpath=(//a[contains(text(),'My Queues')])[2]
    Sleep    2
    ${TotalOptions}=    Get Matching Xpath Count    //div[@id='sidebarNav']/div/a
    ${LocaterCount}=    Set Variable    1
    ${Count}=    Set Variable    0
    : FOR    ${Count}    IN RANGE    ${TotalOptions}
    \    Page Should Contain Element    //div[@id='sidebarNav']/div[${LocaterCount}]/a    No option added on the Queuse page
    \    ${Locator}=    Set Variable    0
    \    Set Global Variable    ${Locator}    //div[@id='sidebarNav']/div[${LocaterCount}]/a
    \    ${CustomName}=    Get Text    //div[@id='sidebarNav']/div[${LocaterCount}]/a
    \    ${CustomName}=    Fetch From Left    ${CustomName}    (
    \    ${CustomName}=    Evaluate    "${CustomName}".strip()
    \    Run Keyword If    '${CustomName}'=='${Name}'    Exit For Loop
    \    ${LocaterCount}=    Evaluate    ${LocaterCount}+1
    \    ${Count}=    Evaluate    ${Count}+1
    \    Run Keyword If    ${Count}==${TotalOptions}    Fail    Added Custom Queues Option not displayed on the Queues page

verifyUIOfCustomQueuePage
    [Documentation]    This script verifies the UI of Custom Queue Page.
    Focus    xpath=(//a[contains(text(),'My Queues')])[2]
    Click Element    xpath=(//a[contains(text(),'My Queues')])[2]
    Sleep    2
    Focus    ${Locator}
    Sleep    4
    Focus    ${Locator}
    Click Element    ${Locator}
    Sleep    1
    Run Keyword And Ignore Error    Confirm Action
    Sleep    2
    ${V1}=    Run Keyword And Return Status    Element Text Should Be    css=h1.subheading    ${Name} Applications    Custom Queue Name has invalid text on Custom Queue Page
    ${V2}=    Run Keyword And Return Status    Page Should Contain Element    //div[@id='mainContent']/div/div/div/div/div/a    View Queue Description and Rules link not present on Custom Queue Page
    ${V3}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='manage_apps_status']/thead/tr/th/span    App#    App# column has invalid text on Custom Queue Page
    ${V4}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='manage_apps_status']/thead/tr/th[2]/span    Primary Applicant    Primary Applicant column has invalid text on Custom Queue Page
    ${V5}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='manage_apps_status']/thead/tr/th[3]/span    Loan Type    Loan Type column has invalid text \ on Custom Queue Page
    ${V6}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='manage_apps_status']/thead/tr/th[4]/span    Amount    Amount column has invalid text \ on Custom Queue Page
    ${V7}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='manage_apps_status']/thead/tr/th[5]/span    Term    Term column has invalid text \ on Custom Queue Page
    ${V8}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='manage_apps_status']/thead/tr/th[6]/span    Channel    Channel column has invalid text \ on Custom Queue Page
    ${V9}=    Run Keyword And Return Status    Page Should Contain Element    //table[@id='manage_apps_status']/thead/tr/th[7]/span/select    All Statuses drop down not present on Custom Queue Page
    ${V10}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='manage_apps_status']/thead/tr/th[8]/span    Updated On    Updated On column has invalid text \ on Custom Queue Page
    ${V11}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='manage_apps_status']/thead/tr/th[9]/span    By    By \ column has invalid text \ on Custom Queue Page
    ${V12}=    Run Keyword And Return Status    Element Text Should Be    //table[@id='manage_apps_status']/thead/tr/th[10]/span    Expiring    Expiring column has invalid text \ on Custom Queue Page
    ${V13}=    Run Keyword And Return Status    Page Should Contain Element    css=select[name="manage_apps_status_length"]    View All drop down not present on Custom Queue Page
    ${V14}=    Run Keyword And Return Status    Page Should Contain Element    //div[@id='manage_apps_status_length']/label    Per Page label not present on Custom Queue Page
    ${V15}=    Run Keyword And Return Status    Page Should Contain Element    //a[contains(text(),'← Previous')]    Previous link not present on Custom Queue Page
    ${V16}=    Run Keyword And Return Status    Page Should Contain Element    //a[contains(text(),'Next →')]    Next link not present on Custom Queue Page
    ${V17}=    Run Keyword And Return Status    Page Should Contain Element    css=label > input[type="text"]    Search text box not present on Custom Queue Page
    Focus    //div[@id='mainContent']/div/div/div/div/div/a
    Click Element    //div[@id='mainContent']/div/div/div/div/div/a
    ${V18}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='queue_info']/div/div/div/span    ${Name} - ${Description}    Name and Description \ has invalid text on Custom Queue page
    Focus    //div[@id='accordion2']/a
    Click Element    //div[@id='accordion2']/a
    Sleep    1
    ${V19}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='queue_rules']/table/tbody/tr/td/table/tbody/tr/td/span    Custom Queue Criteria 1    Criteria name \ has invalid text on Custom Queue page
    ${V20}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='queue_rules']/table/tbody/tr/td/table/tbody/tr/td[2]    If    Condition has invalid text on Custom Queue page
    ${V21}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='queue_rules']/table/tbody/tr/td/table/tbody/tr/td[3]    ${Attribute}    Attribute has invalid text on Custom Queue page
    ${V22}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='queue_rules']/table/tbody/tr/td/table/tbody/tr/td[4]    ${Method}    Method Operator has invalid text on Custom Queue page
    ${V23}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='queue_rules']/table/tbody/tr/td/table/tbody/tr/td[5]    ${Value}    Value has invalid text on Custom Queue page
    @{Verification}=    Create List    ${V1}    ${V2}    ${V3}    ${V4}    ${V5}
    ...    ${V6}    ${V7}    ${V8}    ${V9}    ${V10}    ${V11}
    ...    ${V12}    ${V13}    ${V14}    ${V15}    ${V16}    ${V17}
    ...    ${V18}    ${V19}    ${V20}    ${V21}    ${V22}    ${V23}
    @{Messages}=    Create List    Custom Queue Name has invalid text on Custom Queue Page    View Queue Description and Rules link not present on Custom Queue Page    App# column has invalid text on Custom Queue Page    Primary Applicant column has invalid text on Custom Queue Page    Loan Type column has invalid text \ on Custom Queue Page
    ...    Amount column has invalid text \ on Custom Queue Page    Term column has invalid text \ on Custom Queue Page    Channel column has invalid text \ on Custom Queue Page    All Statuses drop down not present on Custom Queue Page    Updated On column has invalid text \ on Custom Queue Page    By \ column has invalid text \ on Custom Queue Page
    ...    Expiring column has invalid text \ on Custom Queue Page    View All drop down not present on Custom Queue Page    Per Page label not present on Custom Queue Page    Previous link not present on Custom Queue Page    Next link not present on Custom Queue Page    Search text box not present on Custom Queue Page
    ...    Name and Description \ has invalid text on Custom Queue page    Criteria name \ has invalid text on Custom Queue page    Condition has invalid text on Custom Queue page    Attribute has invalid text on Custom Queue page    Method Operator has invalid text on Custom Queue page    Value has invalid text on Custom Queue page
    Set Global Variable    @{GlobalFailureMessages}    @{Messages}
    verifyFailuresFromExecution    @{Verification}
    Run Keyword If    ${FailureCount}>0    Fail    ${MessageToDisplay}

verifyClickOfLinkViewQueueDescriptionAndRules
    [Documentation]    This script verifies the Rules and description of Custom Queue.
    Focus    xpath=(//a[contains(text(),'My Queues')])[2]
    Click Element    xpath=(//a[contains(text(),'My Queues')])[2]
    Sleep    2
    Focus    ${Locator}
    Sleep    5
    Focus    ${Locator}
    Click Element    ${Locator}
    Sleep    2
    Run Keyword And Ignore Error    Confirm Action
    Sleep    2
    Page Should Contain Element    //div[@id='accordion']/a    View Queue Description and Rules link not appears on the \ "${Name} Application " view page
    Comment    Verify Expand Functionality
    Focus    //div[@id='accordion']/a
    Click Element    //div[@id='accordion']/a
    Sleep    2
    ${V1}=    Run Keyword And Return Status    Element Should Be Visible    //div[@id='queue_info']/div/div/div/span/b    View Queue Description and Rules grid not expanded after clicking on View Queue Description and Rules link button
    Comment    Verify Collapse Functionality
    Focus    //div[@id='accordion']/a
    Click Element    //div[@id='accordion']/a
    Sleep    1
    ${V2}=    Run Keyword And Return Status    Element Should Not Be Visible    //div[@id='queue_info']/div/div/div/span/b    View Queue Description and Rules grid not collapsed after clicking on View Queue Description and Rules link button second time
    @{Verification}=    Create List    ${V1}    ${V2}
    @{Messages}=    Create List    View Queue Description and Rules grid not expanded after clicking on View Queue Description and Rules link button    View Queue Description and Rules grid not collapsed after clicking on View Queue Description and Rules link button second time
    Set Global Variable    @{GlobalFailureMessages}    @{Messages}
    verifyFailuresFromExecution    @{Verification}
    Run Keyword If    ${FailureCount}>0    Fail    ${MessageToDisplay}

verifyUIOfViewQueueDescriptionAndRulesGrid
    [Documentation]    This script verifies the UI Of View Queue Description And Rules Grid.
    Focus    xpath=(//a[contains(text(),'My Queues')])[2]
    Click Element    xpath=(//a[contains(text(),'My Queues')])[2]
    Sleep    2
    Focus    ${Locator}
    Sleep    5
    Focus    ${Locator}
    Click Element    ${Locator}
    Sleep    2
    Run Keyword And Ignore Error    Confirm Action
    Sleep    2
    Focus    //div[@id='accordion']/a
    Click Element    //div[@id='accordion']/a
    Sleep    2
    Wait Until Page Contains Element    //div[@id='queue_info']/div/div/div/span    ${Timeout}    View Queue Description and Rules grid not opened
    ${V1}=    Run Keyword And Return Status    Element Text Should Be    css=b    ${Name}    Queue Name has invalid text in View Queue Description and Rules grid
    ${V2}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='queue_info']/div/div/div/span    ${Name} - ${Description}    Queue Descriptionhas invalid text on View Queue Description and Rules grid
    Focus    //div[@id='accordion2']/a
    Click Element    //div[@id='accordion2']/a
    Sleep    2
    ${V3}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='queue_rules']/table/thead/tr/th    Custom Queue Criteria    Custom Queue Criteria column name has invalid text in View Queue Description and Rules grid
    ${V4}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='queue_rules']/table/thead/tr/th[2]    Condition    Condition column name has invalid text in View Queue Description and Rules grid
    ${V5}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='queue_rules']/table/thead/tr/th[3]    Attribute    Attribute column name has invalid text in View Queue Description and Rules grid
    ${V6}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='queue_rules']/table/thead/tr/th[4]    Method    Method column name has invalid text in View Queue Description and Rules grid
    ${V7}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='queue_rules']/table/thead/tr/th[5]    Value    Value column name has invalid text in View Queue Description and Rules grid
    @{Verification}=    Create List    ${V1}    ${V2}    ${V3}    ${V4}    ${V5}
    ...    ${V6}    ${V7}
    @{Messages}=    Create List    Custom Queue Name has invalid text on Custom Queue Page    Queue Descriptionhas invalid text on View Queue Description and Rules grid    Custom Queue Criteria column name has invalid text in View Queue Description and Rules grid    Condition column name has invalid text in View Queue Description and Rules grid    Attribute column name has invalid text in View Queue Description and Rules grid
    ...    Method column name has invalid text in View Queue Description and Rules grid    Value column name has invalid text in View Queue Description and Rules grid
    Set Global Variable    @{GlobalFailureMessages}    @{Messages}
    verifyFailuresFromExecution    @{Verification}
    Run Keyword If    ${FailureCount}>0    Fail    ${MessageToDisplay}

addNewCustomQueueDisabledAndVerify
    [Documentation]    This script add new Custom Queue with disabled status.
    ${Name}=    Generate Random String    7    [LETTERS]
    ${Description}=    Generate Random String    7    [LETTERS]
    Set Global Variable    ${Name}    ${Name}
    addNewCustomQueue    ${Name}    ${Description}    Disabled
    Sleep    1
    Page Should Contain Element    link=Add Queue    Add New Custome Queue not working properly.
    Comment    Verifies on the Queues Page
    Focus    xpath=(//a[contains(text(),'My Queues')])[2]
    Click Element    xpath=(//a[contains(text(),'My Queues')])[2]
    Sleep    2
    ${TotalOptions}=    Get Matching Xpath Count    //div[@id='sidebarNav']/div/a
    ${LocaterCount}=    Set Variable    1
    ${Count}=    Set Variable    0
    : FOR    ${Count}    IN RANGE    ${TotalOptions}
    \    Page Should Contain Element    //div[@id='sidebarNav']/div[${LocaterCount}]/a    No option added on the Queuse page
    \    ${Locator}=    Set Variable    0
    \    Set Global Variable    ${Locator}    //div[@id='sidebarNav']/div[${LocaterCount}]/a
    \    ${CustomName}=    Get Text    //div[@id='sidebarNav']/div[${LocaterCount}]/a
    \    ${CustomName}=    Fetch From Left    ${CustomName}    (
    \    ${CustomName}=    Evaluate    "${CustomName}".strip()
    \    Run Keyword If    '${CustomName}'=='${Name}'    Fail    Added Disabled Custom Queues Option displayed on the Queues page
    \    ${LocaterCount}=    Evaluate    ${LocaterCount}+1
    \    ${Count}=    Evaluate    ${Count}+1
    \    Run Keyword If    ${Count}==${TotalOptions}    Exit For Loop

searchFunctionality
    [Documentation]    This script verifies the search functionality with Two , Three and Four characters.
    goToManageCustomQueuesPage
    Comment    Search by 2 characters
    ${TwoCharacters}=    Get Substring    ${Name}    0    2
    ${V1}=    Run Keyword And Return Status    searchByCharacters    ${TwoCharacters}
    Comment    Three Characters Search
    ${ThreeCharacters}=    Get Substring    ${Name}    0    3
    ${V2}=    Run Keyword And Return Status    searchByCharacters    ${ThreeCharacters}
    Comment    Four Characters Search
    ${FourCharacters}=    Get Substring    ${Name}    0    4
    ${V3}=    Run Keyword And Return Status    searchByCharacters    ${ThreeCharacters}
    @{Verification}=    Create List    ${V1}    ${V2}    ${V3}
    @{Messages}=    Create List    Search With Two characters is not working on Manage Custom Queues Page    Search With Three characters is not working on Manage Custom Queues Page    Search With Four characters is not working on Manage Custom Queues Page
    Set Global Variable    @{GlobalFailureMessages}    @{Messages}
    verifyFailuresFromExecution    @{Verification}
    Run Keyword If    ${FailureCount}>0    Fail    ${MessageToDisplay}

verifyRequiredFieldValidation
    [Documentation]    This script verifies the required filed validation message appear on the Create Custom Queues Page
    goToManageCustomQueuesPage
    Click Element    link=Add Queue
    Sleep    2
    Focus    id=enabled
    Click Element    id=enabled
    Focus    css=input.btn.btn-success
    Click Element    css=input.btn.btn-success
    Sleep    2
    ${V1}=    Run Keyword And Return Status    Element Should Be Visible    //div[@id='mainContent']/form/div/div[3]/div/div/small    Name required field validation message not appear on the Create Custom Queues Page
    ${V2}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='mainContent']/form/div/div[3]/div/div/small    This field is required.    This field is required.validation \ message of Name field has invalid text on Create Custom Queues Page
    ${V3}=    Run Keyword And Return Status    Element Should Be Visible    //tr[@id='-1_-1_criteriaRow']/td[4]/small    Attribute \ required field validation message not appear on the Create Custom Queues Page
    ${V4}=    Run Keyword And Return Status    Element Text Should Be    //tr[@id='-1_-1_criteriaRow']/td[4]/small    This field is required.    This field is required.validation \ message of Attribute \ field has invalid text on Create Custom Queues Page
    ${V5}=    Run Keyword And Return Status    Element Should Be Visible    //tr[@id='-1_-1_criteriaRow']/td[5]/small    Method \ required field validation message not appear on the Create Custom Queues Page
    ${V6}=    Run Keyword And Return Status    Element Text Should Be    //tr[@id='-1_-1_criteriaRow']/td[5]/small    This field is required.    This field is required.validation \ message of Method field has invalid text on Create Custom Queues Page
    ${V7}=    Run Keyword And Return Status    Element Should Be Visible    //tr[@id='-1_-1_criteriaRow']/td[6]/div/small    Value \ required field validation message not appear on the Create Custom Queues Page
    ${V8}=    Run Keyword And Return Status    Element Text Should Be    //tr[@id='-1_-1_criteriaRow']/td[6]/div/small    This field is required.    This field is required.validation \ message of Value field has invalid text on Create Custom Queues Page
    @{Verification}=    Create List    ${V1}    ${V2}    ${V3}    ${V4}    ${V5}
    ...    ${V6}    ${V7}    ${V8}
    @{Messages}=    Create List    Name required field validation message not appear on the Create Custom Queues Page    This field is required.validation \ message of Name field has invalid text on Create Custom Queues Page    Attibute \ required field validation message not appear on the Create Custom Queues Page    This field is required.validation \ message of Attribute \ field has invalid text on Create Custom Queues Page    Method \ required field validation message not appear on the Create Custom Queues Page
    ...    This field is required.validation \ message of Method field has invalid text on Create Custom Queues Page    Value \ required field validation message not appear on the Create Custom Queues Page    This field is required.validation \ message of Value field has invalid text on Create Custom Queues Page
    Set Global Variable    @{GlobalFailureMessages}    @{Messages}
    verifyFailuresFromExecution    @{Verification}
    Run Keyword If    ${FailureCount}>0    Fail    ${MessageToDisplay}

verifyAddDeleteButtonsInCustomQueueCriteriaSection
    [Documentation]    This script verifies the button functionality in the Custom Criteria Section
    ...    Add Row
    ...    Delete Row
    ...    Add Criteria
    ...    Delete Criteria
    goToManageCustomQueuesPage
    Click Element    link=Add Queue
    Sleep    1
    Wait Until Page Contains Element    name=name    ${Timeout}    Create Custom Queue \ page not loaded properly
    Sleep    1
    Comment    Verify Add New Criteria \ Row Functionality
    Focus    //div[@id='criteriaSetDiv_-1']/table/tbody/tr[2]/td[7]/a/i
    Click Element    //div[@id='criteriaSetDiv_-1']/table/tbody/tr[2]/td[7]/a/i
    Sleep    1
    ${V1}=    Run Keyword And Return Status    Element Should Be Visible    id=unique5    New Row not added to the \ Custom Queues Criteria on \ Create Custome Queues Page after clicking on the Add Row Button
    Comment    Verify Delete Row functionality
    Focus    //tr[@id='-1_-2_criteriaRow']/td[7]/a/i
    Click Element    //tr[@id='-1_-2_criteriaRow']/td[7]/a/i
    Sleep    1
    ${V2}=    Run Keyword And Return Status    Element Should Not Be Visible    id=unique5    Added Row not deleleted From \ \ Custom Queues Criteria on \ Create Custome Queues Page after clicking on the Delete \ Row Button
    Comment    Verify Add Criteria \ Functionality
    Focus    //div[@id='criteriaSetDiv_-1']/table/tbody/tr/td[3]/div/button
    Click Element    //div[@id='criteriaSetDiv_-1']/table/tbody/tr/td[3]/div/button
    Sleep    1
    ${V3}=    Run Keyword And Return Status    Element Should Be Visible    id=unique8    New Criteria not added after clicking on the Add New Criteria Button on Create Custom Queues Page
    ${V4}=    Run Keyword And Return Status    Textfield Value Should Be    id=unique8    Custom Queue Criteria 2    Custom Queue Criteria 2 text box has invalid text on the Create Custom Queues Page
    Comment    Verify Delete \ Criteria \ Functionality
    Focus    xpath=(//button[@type='button'])[2]
    Click Element    xpath=(//button[@type='button'])[2]
    Sleep    1
    ${V5}=    Run Keyword And Return Status    Element Should Not Be Visible    id=unique1    Custom Queue Criteria 1 not deleted after clicking on the Delete Criteria button on Create Custom Queues Page
    @{Verification}=    Create List    ${V1}    ${V2}    ${V3}    ${V4}    ${V5}
    @{Messages}=    Create List    New Row not added to the \ Custom Queues Criteria on \ Create Custome Queues Page after clicking on the Add Row Button    Added Row not deleleted From \ \ Custom Queues Criteria on \ Create Custome Queues Page after clicking on the Delete \ Row Button    New Criteria not added after clicking on the Add New Criteria Button on Create Custom Queues Page    Custom Queue Criteria 2 text box has invalid text on the Create Custom Queues Page    Custom Queue Criteria 1 not deleted after clicking on the Delete Criteria button on Create Custom Queues Page
    Set Global Variable    @{GlobalFailureMessages}    @{Messages}
    verifyFailuresFromExecution    @{Verification}
    Run Keyword If    ${FailureCount}>0    Fail    ${MessageToDisplay}

verifyLinksAndButtons
    [Documentation]    This scripts verifies the Links on Create Custom Queues Page
    ...    Cancel
    ...    Manage Custom Queues
    ...    Cancel Button
    goToManageCustomQueuesPage
    Click Element    link=Add Queue
    Sleep    1
    Wait Until Page Contains Element    name=name    ${Timeout}    Create Custom Queue \ page not loaded properly
    Comment    verify Manage Custom Queues Link
    Focus    link=Manage Queues
    Click Element    link=Manage Queues
    Sleep    1
    ${V1}=    Run Keyword And Return Status    Element Should Be Visible    link=Add Queue    User not redirected to the Manage Custom Queues Page after clicking on the "Manage Custom Queues" link
    Click Element    link=Add Queue
    Sleep    1
    Wait Until Page Contains Element    name=name    ${Timeout}    Create Custom Queue \ page not loaded properly
    Comment    verify Cancel ink
    Focus    link=Cancel
    Click Element    link=Cancel
    Sleep    1
    ${V2}=    Run Keyword And Return Status    Element Should Be Visible    link=Add Queue    User not redirected to the Manage Custom Queues Page after clicking on the "Cancel" link
    Click Element    link=Add Queue
    Sleep    1
    Wait Until Page Contains Element    name=name    ${Timeout}    Create Custom Queue \ page not loaded properly
    Comment    verify \ Cancel Button
    Focus    xpath=(//a[contains(text(),'Cancel')])[2]
    Click Element    xpath=(//a[contains(text(),'Cancel')])[2]
    Sleep    1
    ${V3}=    Run Keyword And Return Status    Element Should Be Visible    link=Add Queue    User not redirected to the Manage Custom Queues Page after clicking on the "Cancel" button
    @{Verification}=    Create List    ${V1}    ${V2}    ${V3}
    @{Messages}=    Create List    User not redirected to the Manage Custom Queues Page after clicking on the "Manage Custom Queues" link    User not redirected to the Manage Custom Queues Page after clicking on the "Cancel" link    User not redirected to the Manage Custom Queues Page after clicking on the "Cancel" button
    Set Global Variable    @{GlobalFailureMessages}    @{Messages}
    verifyFailuresFromExecution    @{Verification}
    Run Keyword If    ${FailureCount}>0    Fail    ${MessageToDisplay}

verifyUpdateFunctionality
    [Documentation]    This script verifies the Update Functionality for the Custom Queues and verifies on the Queues Page
    ${Name}=    Generate Random String    7    [LETTERS]
    ${Description}=    Generate Random String    7    [LETTERS]
    Set Global Variable    ${Name}    ${Name}
    Set Global Variable    ${Description}    ${Description}
    addNewCustomQueue    ${Name}    ${Description}    Enabled
    Sleep    1
    Page Should Contain Element    link=Add Queue    Add New Custome Queue not working properly.
    Comment    Verifies on the Queues Page
    Focus    xpath=(//a[contains(text(),'My Queues')])[2]
    Click Element    xpath=(//a[contains(text(),'My Queues')])[2]
    Sleep    2
    ${TotalOptions}=    Get Matching Xpath Count    //div[@id='sidebarNav']/div/a
    ${LocaterCount}=    Set Variable    1
    ${Count}=    Set Variable    0
    : FOR    ${Count}    IN RANGE    ${TotalOptions}
    \    Page Should Contain Element    //div[@id='sidebarNav']/div[${LocaterCount}]/a    No option added on the Queuse page
    \    ${Locator}=    Set Variable    0
    \    Set Global Variable    ${Locator}    //div[@id='sidebarNav']/div[${LocaterCount}]/a
    \    ${CustomName}=    Get Text    //div[@id='sidebarNav']/div[${LocaterCount}]/a
    \    ${CustomName}=    Fetch From Left    ${CustomName}    (
    \    ${CustomName}=    Evaluate    "${CustomName}".strip()
    \    Run Keyword If    '${CustomName}'=='${Name}'    Exit For Loop
    \    ${LocaterCount}=    Evaluate    ${LocaterCount}+1
    \    ${Count}=    Evaluate    ${Count}+1
    \    Run Keyword If    ${Count}==${TotalOptions}    Fail    Added Custom Queues Option not displayed on the Queues page
    goToManageCustomQueuesPage
    Focus    link=${Name}
    Click Element    link=${Name}
    Sleep    1
    Focus    link=Edit
    Click Element    link=Edit
    Sleep    1
    Comment    Update Details and Verifies
    ${UpdatedName}=    Generate Random String    7    [LETTERS]
    ${UpdatedDescription}=    Generate Random String    7    [LETTERS]
    Focus    name=name
    Input Text    name=name    ${UpdatedName}
    Focus    name=description
    Input Text    name=description    ${UpdatedDescription}
    Focus    link=Save
    Click Element    link=Save
    Sleep    2
    ${V1}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='mainContent']/div/div[3]/div/span/b    ${UpdatedName}    Queues name not updated correctly on View Page
    ${V2}=    Run Keyword And Return Status    Element Text Should Be    //div[@id='mainContent']/div/div[3]/div/span    ${UpdatedDescription}    Queues name not updated correctly on View Page
    Comment    Verifies on the Queues Page
    Focus    xpath=(//a[contains(text(),'My Queues')])[2]
    Click Element    xpath=(//a[contains(text(),'My Queues')])[2]
    Sleep    2
    ${TotalOptions}=    Get Matching Xpath Count    //div[@id='sidebarNav']/div/a
    ${LocaterCount}=    Set Variable    1
    ${Count}=    Set Variable    0
    : FOR    ${Count}    IN RANGE    ${TotalOptions}
    \    Page Should Contain Element    //div[@id='sidebarNav']/div[${LocaterCount}]/a    No option added on the Queuse page
    \    ${Locator}=    Set Variable    0
    \    Set Global Variable    ${Locator}    //div[@id='sidebarNav']/div[${LocaterCount}]/a
    \    ${CustomName}=    Get Text    //div[@id='sidebarNav']/div[${LocaterCount}]/a
    \    ${CustomName}=    Fetch From Left    ${CustomName}    (
    \    ${CustomName}=    Evaluate    "${CustomName}".strip()
    \    Run Keyword If    '${CustomName}'=='${UpdatedName}'    Exit For Loop
    \    ${LocaterCount}=    Evaluate    ${LocaterCount}+1
    \    ${Count}=    Evaluate    ${Count}+1
    \    Run Keyword If    ${Count}==${TotalOptions}    Fail    Updated Custom Queues Option not displayed on the Queues page

verifyAddedQueueDisplayedBelowToSystemQueues
    [Documentation]    This script verifies the added custom queue displayed on the Queues Page after System options
    ${Name}=    Generate Random String    7    [LETTERS]
    ${Description}=    Generate Random String    7    [LETTERS]
    Set Global Variable    ${Name}    ${Name}
    Set Global Variable    ${Description}    ${Description}
    addNewCustomQueue    ${Name}    ${Description}    Enabled
    Sleep    1
    Page Should Contain Element    link=Add Queue    Add New Custome Queue not working properly.
    Comment    Verifies on the Queues Page displayed after System Queues
    Focus    xpath=(//a[contains(text(),'My Queues')])[2]
    Click Element    xpath=(//a[contains(text(),'My Queues')])[2]
    Sleep    2
    ${LocaterCount}=    Set Variable    1
    ${Count}=    Set Variable    0
    : FOR    ${Count}    IN RANGE    9
    \    Page Should Contain Element    //div[@id='sidebarNav']/div[${LocaterCount}]/a    No option added on the Queuse page
    \    ${Locator}=    Set Variable    0
    \    Set Global Variable    ${Locator}    //div[@id='sidebarNav']/div[${LocaterCount}]/a
    \    ${CustomName}=    Get Text    //div[@id='sidebarNav']/div[${LocaterCount}]/a
    \    ${CustomName}=    Fetch From Left    ${CustomName}    (
    \    ${CustomName}=    Evaluate    "${CustomName}".strip()
    \    Run Keyword If    '${CustomName}'=='${Name}'    Fail    Added Custom Queue displayed before the System Queues options on the Queues Page
    \    ${LocaterCount}=    Evaluate    ${LocaterCount}+1
    \    ${Count}=    Evaluate    ${Count}+1
    \    Run Keyword If    ${Count}==9    Exit For Loop
    Comment    Verifies added Queues
    ${TotalOptions}=    Get Matching Xpath Count    //div[@id='sidebarNav']/div/a
    ${LocaterCount}=    Set Variable    9
    ${Count}=    Set Variable    9
    : FOR    ${Count}    IN RANGE    ${TotalOptions}
    \    Page Should Contain Element    //div[@id='sidebarNav']/div[${LocaterCount}]/a    No option added on the Queuse page
    \    ${Locator}=    Set Variable    0
    \    Set Global Variable    ${Locator}    //div[@id='sidebarNav']/div[${LocaterCount}]/a
    \    ${CustomName}=    Get Text    //div[@id='sidebarNav']/div[${LocaterCount}]/a
    \    ${CustomName}=    Fetch From Left    ${CustomName}    (
    \    ${CustomName}=    Evaluate    "${CustomName}".strip()
    \    Run Keyword If    '${CustomName}'=='${Name}'    Exit For Loop
    \    ${LocaterCount}=    Evaluate    ${LocaterCount}+1
    \    ${Count}=    Evaluate    ${Count}+1
    \    Run Keyword If    ${Count}==${TotalOptions}    Fail    Added Custom Queues Option not displayed on the Queues page

*** Keywords ***
goToManageCustomQueuesPage
    [Documentation]    This keyword is used to navigate to the Manage Branches Pages
    Click Element    link=Admin
    Sleep    1
    Wait Until Page Contains Element    link=Lender Settings    ${Timeout}    Lender Settings \ section not appear on page
    Focus    link=Lender Settings
    Click Element    link=Lender Settings
    Sleep    1
    Wait Until Page Contains Element    link=Queues    ${Timeout}    Queues \ link not found under the Lender Setting Tab
    Click Element    link=Queues
    Sleep    1
    Wait Until Page Contains Element    link=Add Queue    ${Timeout}    Manage Queues Page not loaded or User Redirected to the Other Page

addNewCustomQueue
    [Arguments]    ${Name}    ${Description}    ${Status}    # Please pass the exact value as required
    [Documentation]    This keyword is used to add New Custom Queuse
    Click Element    link=Admin
    Sleep    1
    Wait Until Page Contains Element    link=Lender Settings    ${Timeout}    Lender Settings \ section not appear on page
    Click Element    link=Lender Settings
    Sleep    1
    Wait Until Page Contains Element    link=Queues    ${Timeout}    Queues link not appear on page
    Focus    link=Queues
    Click Element    link=Queues
    Sleep    1
    Wait Until Page Contains Element    link=Add Queue    ${Timeout}    Manage Queues page not loaded properly
    Click Element    link=Add Queue
    Sleep    1
    Wait Until Page Contains Element    name=name    ${Timeout}    Create Custom Queues page not loaded properly
    Focus    name=name
    Input Text    name=name    ${Name}
    Sleep    1
    Focus    name=description
    Input Text    name=description    ${Description}
    Sleep    1
    Focus    id=enabled
    Run Keyword If    '${Status}'=='Enabled'    Select Checkbox    id=enabled
    Sleep    1
    Focus    //select[@id='unique2']
    Select From List By Index    //select[@id='unique2']    1
    Sleep    1
    ${Attribute}=    Get Selected List Label    //select[@id='unique2']
    Set Global Variable    ${Attribute}    ${Attribute}
    Focus    //select[@id='unique3']
    Select From List By Index    //select[@id='unique3']    1
    Sleep    1
    ${Method}=    Get Selected List Label    //select[@id='unique3']
    Set Global Variable    ${Method}    ${Method}
    Focus    //select[@id='unique4']
    Select From List By Index    //select[@id='unique4']    1
    Sleep    1
    ${Value}=    Get Selected List Label    //select[@id='unique4']
    Set Global Variable    ${Value}    ${Value}
    Focus    //div[@id='mainContent']/form/div/div[5]/div/input
    Click Element    //div[@id='mainContent']/form/div/div[5]/div/input
    Sleep    2
    Wait Until Page Contains Element    //div[@id='mainContent']/div/div/div/a    ${Timeout}    New Custom Queue not Saved

searchByCharacters
    [Arguments]    ${Searchtext}
    [Documentation]    This keword is used to search the Custome Queues
    Sleep    1
    Wait Until Page Contains Element    name=mngCustomQueues_length    ${Timeout}    Manage Custome Queues Page not loaded properly
    Focus    css=label > input[type="text"]
    Input Text    css=label > input[type="text"]    ${Searchtext}
    ${Rows}=    Get Matching Xpath Count    //table[@id='mngBranches']/tbody/tr/td[1]
    ${Count}=    Evaluate    ${Rows}
    ${RowNumber}=    Set Variable
    : FOR    ${Rows}    IN RANGE    ${Count}
    \    Sleep    1
    \    Log    ${Count}
    \    ${Rows}=    Evaluate    ${Rows}+1
    \    ${Name}=    Get Text    //tr[${Rows}]/td/a
    \    ${Desc}=    Get Text    //tr[${Rows}]/td[2]
    \    ${Total Count}=    Get Text    //tr[${Rows}]/td[3]
    \    ${UpdatedOn}=    Get Text    //tr[${Rows}]/td[4]
    \    ${By}=    Get Text    //tr[${Rows}]/td[6]
    \    ${Status}=    Get Text    //tr[${Rows}]/td[7]
    \    ${Searched Text}=    Evaluate    "${Name}"+" "+"${Desc}"+" "+"${Total Count}"+" "+"${UpdatedOn}"+" "+"${By}"+" "+"${Status}"
    \    ${Result}=    Get Lines Containing String    ${Searched Text}    ${Searchtext}    False
    \    Run Keyword If    '${Result}'==''    Fail    searching by "${Searchtext}" characters does not display right results
    \    Run Keyword If    ${Rows}==${Count}    Exit For Loop
